---
// Contact.astro - Full-screen Spline Component
import SplineViewer from './SplineViewer.astro';
---

<!-- Full-screen Spline Component -->
<section class="zmm-spline-wrap">
  <!-- Spline Interactive Component -->
  <SplineViewer 
    url="https://prod.spline.design/sJNgnd62gk6NvzYE/scene.splinecode"
    class="zmm-spline"
    title="Spline â€” Contact Page Interactive Component"
    loading="lazy"
  />

  <!-- Logo Overlay -->
  <div class="zmm-logo-overlay">
    <a href="/" class="zmm-logo-link" aria-label="Return to ZeroMotion Marketing home page">
      <video 
        class="zmm-logo-video"
        autoplay 
        muted 
        loop 
        playsinline
        preload="metadata"
      >
        <source src="/media/ZeroMotion-Transparent-OBS-v2.webm" type="video/webm">
        <!-- Fallback for browsers that don't support WebM -->
        <source src="/media/ZeroMotion-Transparent.mov" type="video/mp4">
      </video>
    </a>
  </div>
</section>

<style>
  .zmm-spline-wrap {
    position: relative;
    inset: 0;
    width: 100%;
    /* svh handles iOS dynamic address bar better than vh */
    height: 100svh;
    background: #000;
    overflow: hidden;
  }

  /* Mobile-specific wrapper adjustments */
  @media (max-width: 767px) {
    .zmm-spline-wrap {
      /* Ensure no gaps on mobile */
      width: 100vw;
      height: 100vh;
      height: 100svh;
      position: fixed;
      top: 0;
      left: 0;
    }
  }

  .zmm-spline {
    position: absolute;
    inset: 0;
    width: 100%;
    height: 100%;
    border: 0;
    display: block;
    /* Full pointer events for Spline interactions */
    pointer-events: auto;
  }

  /* Desktop scaling for Spline */
  @media (min-width: 768px) {
    .zmm-spline {
      width: 100%;
      height: 100%;
      transform: scale(1);
      transform-origin: center center;
    }
  }

  /* Mobile-specific Spline scaling */
  @media (max-width: 767px) {
    .zmm-spline {
      width: 150%; /* Zoom out to show more of the component */
      height: 150%;
      transform: scale(0.67); /* Scale down to fit viewport */
      transform-origin: center center;
      left: -25%; /* Center the scaled content */
      top: -25%;
    }
  }

  .zmm-logo-overlay {
    position: absolute;
    top: clamp(16px, 3vh, 32px);
    left: clamp(16px, 3vw, 32px);
    z-index: 10;
    /* Prevent logo from interfering with Spline interactions */
    pointer-events: none;
  }

  .zmm-logo-link {
    display: block;
    /* Re-enable pointer events for the logo link */
    pointer-events: auto;
    transition: transform 0.2s ease, opacity 0.2s ease;
    border-radius: 8px;
    overflow: hidden;
  }

  .zmm-logo-link:hover {
    transform: scale(1.05);
    opacity: 0.9;
  }

  .zmm-logo-link:active {
    transform: scale(0.98);
  }

  .zmm-logo-video {
    display: block;
    width: clamp(80px, 12vw, 120px);
    height: auto;
    /* Maintain aspect ratio */
    object-fit: contain;
    /* Smooth edges */
    border-radius: 6px;
  }

  /* Mobile adjustments */
  @media (max-width: 480px) {
    .zmm-logo-overlay {
      top: 12px;
      left: 12px;
    }
    
    .zmm-logo-video {
      width: clamp(60px, 15vw, 80px);
    }
    
    /* Extra zoom out for very small screens */
    .zmm-spline {
      width: 180%; /* Even more zoom out for small screens */
      height: 180%;
      transform: scale(0.56); /* Smaller scale */
      left: -40%; /* Adjust centering */
      top: -40%;
    }
  }
</style>

<script>
  // iOS viewport fix on orientation changes for the Spline component
  const setSVH = () => {
    const element = document.querySelector('.zmm-spline-wrap') as HTMLElement;
    if (element) {
      element.style.setProperty('height', window.innerHeight + 'px');
    }
  };
  window.addEventListener('resize', setSVH);
  window.addEventListener('orientationchange', setSVH);
  setSVH();
</script>
